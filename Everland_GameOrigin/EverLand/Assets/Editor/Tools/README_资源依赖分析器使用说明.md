# 🔍 Unity 资源依赖分析器使用说明

## 📋 概述

这是一个专为Unity项目设计的资源依赖分析工具，可以帮助开发者分析项目中的资源依赖关系，优化资源打包和加载策略。

## 🚀 快速开始

### 1. 打开分析器
- 在Unity编辑器顶部菜单栏找到 `Tools` 选项
- 点击 `Tools → 依赖分析 → 资源依赖分析器`
- 分析器窗口将自动打开

### 2. 使用方法
- **分析选中资源**：在Project窗口中选择资源，然后点击"分析选中资源"
- **分析所有资源**：点击"分析所有资源"按钮分析整个项目
- **右键菜单**：在Project窗口中右键选中资源，选择"依赖分析 → 查找资源引用"

## 🎯 功能详解

### 分析控制
- **🔄 分析选中资源**：分析当前在Project窗口中选中的资源
- **🌍 分析所有资源**：分析项目中的所有资源（可能需要较长时间）
- **🗑️ 清除结果**：清除当前的分析结果

### 分析结果
分析完成后会显示以下信息：

#### 📈 被引用最多的资源
- 显示被多个资源引用的资源
- 按引用次数排序
- 帮助识别共享资源

#### 🔍 未被引用的资源
- 显示未被任何资源引用的资源
- 排除脚本和着色器文件
- 帮助清理无用资源

#### 🔄 循环依赖检查
- 检测资源间的循环依赖关系
- 帮助避免打包问题

## 🛠️ 技术实现

### 核心功能
- **依赖关系构建**：使用`AssetDatabase.GetDependencies()`获取资源依赖
- **反向依赖映射**：构建资源被引用关系图
- **循环依赖检测**：检测资源间的循环引用

### 性能优化
- **进度条显示**：分析过程中显示进度条
- **异常处理**：对分析过程中的错误进行捕获和处理
- **内存管理**：合理管理分析数据的内存使用

## 📝 使用场景

### 1. 资源优化
- **识别共享资源**：找到被多个资源引用的共享资源
- **清理无用资源**：发现并删除未被引用的资源
- **优化打包策略**：根据依赖关系优化资源打包

### 2. 项目维护
- **依赖关系梳理**：了解项目中的资源依赖关系
- **循环依赖修复**：发现并修复循环依赖问题
- **资源重构**：在重构时了解资源影响范围

### 3. 性能优化
- **减少包体大小**：删除无用资源
- **优化加载策略**：根据依赖关系优化加载顺序
- **内存优化**：避免重复加载相同资源

## 🔧 使用技巧

### 1. 分析策略
- **小范围分析**：先分析特定文件夹或资源类型
- **全项目分析**：定期进行全项目分析
- **增量分析**：在修改资源后进行增量分析

### 2. 结果解读
- **高引用资源**：考虑将其设为共享资源
- **无引用资源**：检查是否可以安全删除
- **循环依赖**：需要重构资源结构

### 3. 优化建议
- **共享资源**：将高引用资源提取为共享资源
- **资源合并**：将相关资源合并到同一个Bundle
- **延迟加载**：对非关键资源使用延迟加载

## 📊 分析报告示例

```
=== 依赖分析报告 ===
分析时间: 2024-01-15 14:30:25
分析资源数量: 1250
发现依赖关系: 890

📈 被引用最多的资源:
  CommonTexture.png - 被 15 个资源引用
    路径: Assets/Textures/CommonTexture.png
  UI_Button.prefab - 被 12 个资源引用
    路径: Assets/Prefabs/UI/UI_Button.prefab

🔍 未被引用的资源:
  OldTexture.png
    路径: Assets/Textures/Old/OldTexture.png
  UnusedModel.fbx
    路径: Assets/Models/UnusedModel.fbx

🔄 循环依赖检查:
  未发现循环依赖
```

## ⚠️ 注意事项

### 1. 分析限制
- **大项目分析**：全项目分析可能需要较长时间
- **内存使用**：分析大量资源时会占用较多内存
- **编辑器性能**：分析过程中可能影响编辑器响应

### 2. 结果准确性
- **动态引用**：无法检测代码中的动态引用
- **间接依赖**：某些间接依赖可能无法完全检测
- **特殊资源**：某些特殊类型的资源可能无法正确分析

### 3. 使用建议
- **定期分析**：建议定期进行依赖分析
- **备份项目**：在删除资源前备份项目
- **测试验证**：删除资源后充分测试项目

## 🐛 常见问题

### Q: 分析时间过长怎么办？
A: 可以先分析特定文件夹或资源类型，避免全项目分析。

### Q: 分析结果不准确怎么办？
A: 某些动态引用无法检测，需要手动检查代码中的资源引用。

### Q: 如何安全删除无引用资源？
A: 建议先备份项目，然后逐个删除并测试，确保不影响项目功能。

### Q: 循环依赖如何解决？
A: 需要重构资源结构，将循环依赖的资源重新组织。

## 📞 技术支持

如有问题或建议，请：
1. 检查Unity Console中的错误信息
2. 确认Unity版本兼容性
3. 查看代码注释了解实现细节

---

**版本**: 1.0  
**适用Unity版本**: 2020.3+  
**最后更新**: 2024年